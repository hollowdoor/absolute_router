!function(t){"use strict";function e(t,e){if(t[e])return t[e];var r={name:e,child:null,parent:t,children:[]},n={__info:r},i=function(n){if(r.type=n,r.property=e.slice(1),t.__info.child)throw new Error("Parent branch "+t.name+" already has a child.");t.__info.child=e};return e.length&&(r.property=e,":"===e[0]?i("parameter"):"*"===e[0]?i("splat"):/^\{[\s\S]+?\}[\s\S]+$/.test(e)?function(n){var i=e.match(/^\{([\s\S]+?)\}([\s\S]+)$/),o=(i[0],i[1]),u=i[2];r.type=n,r.property=u,r.pattern=new RegExp(o),t.__info.children.push(e)}("regex"):/^[0-5]{3}/.test(e)?r.type="error":r.type="normal"),t[e]=n,n}function r(t,r,n){var i=function(e){return e.__info.handler=n,e.__info.children=[],e.__info.path=r,t};return"/"===r?(t.__info={type:"root"},i(t)):i(r.split("/").slice(1).reduce(e,t))}function n(t,e){void 0===e&&(e={});var r=new Error(""+t);return Object.keys(e).forEach(function(t){return r[t]=e[t]}),Promise.reject(r)}var i="undefined"!=typeof window&&"undefined"!=typeof document&&window.URLSearchParams?function(t){for(var e={},r=new URLSearchParams(t.search).entries();;){var n=r.next();if(n.done)break;var i=n.value,o=i[0],u=i[1];e[o]=u}return e}:function(t){return t.search.length?t.search.slice(1).split("&").reduce(function(t,e){var r=e.split("="),n=r[0],i=r[1];return t[n]=i,t},{}):{}},o="undefined"!=typeof window&&"undefined"!=typeof document?window.URL?function(t,e){return/^http/.test(t)?new URL(t,e):new URL(t,window.location.origin)}:function(t){var e=document.createElement("a");return e.href=t,e}:function(t,e){var r=require("url").URL;return"/"===t[0]?new r(t,e||"http://local"):new r(t)},u=function(t){this.store=t,isNaN(t.expire)&&(t.expire=1/0),this.start=Date.now()},s={expire:{},expired:{}};s.expire.get=function(){return this.store.expire},s.expired.get=function(){return this.expire!==1/0&&Date.now()>=this.start+this.expire},u.prototype.respond=function(){this.store.respond()},Object.defineProperties(u.prototype,s),u.isView=function(t){return"object"==typeof t&&"respond"in t&&"function"==typeof t.respond};var a=function(t,e,r,n){this.router=t,this.args=r,this.address=e,this.url=t.location=o(e,n),this.pathname=this.url.pathname,this.handler=null,this.found=!1,this.params={},t.location=this.url,this._route=null},h={route:{},views:{}};h.route.set=function(t){t&&(this._route=t,this.handler=t.__info.handler,this.found=!0,this.search=i(this.url))},h.route.get=function(){return this._route},h.views.get=function(){return this.route?this.route.__info.views:{}},a.prototype.matchRoute=function(){var t=this.router.routes,e=this.pathname;if("/"===e&&t.__info)return this.route=t,this;var r,n,i=e.split("/").slice(1),o=t,u=i.length,s=this.params,a=0,h=function(t,e){s[t.__info.property]=e};for(a=0;a<u;a++){if(n=i[a],r=o,!((o=o[n])||(r.__info.children.length&&function(t,e){for(var r=t.__info.children,n=0;n<r.length;n++){var i=t[r[n]],u=function(t){return e.match(t.__info.pattern)}(i);if(u)return h(i,u),o=t[i.__info.name]}}(r,n),o=function(t){if(t.__info.child)return t[t.__info.child]}(r))))break;"parameter"===o.__info.type?h(o,n):"splat"===o.__info.type&&function(t){for(var e=[];a<u&&!t[i[a]];a++)e.push(i[a]);h(t,e)}(o)}return o&&(this.route=o),this},a.prototype._getArguments=function(){return[this.params,this.search].concat(this.args)},a.prototype.runRoute=function(){if(!this.found){var t=new Error("not found");return t.status=404,Promise.reject(t)}return this.handler.apply(this.router,this._getArguments())},a.prototype.resolve=function(){var t=this;return Promise.resolve().then(function(){return t.matchRoute().runRoute()})},Object.defineProperties(a.prototype,h);var f=function(t){var e=this,r=t.relay,n=t.base;if(this["@@router"]=!0,this.routes={},"function"!=typeof r)throw new Error("options.relay is not a function");r({navigate:function(t,r){return void 0===r&&(r=[]),new a(e,t,r,n).resolve()}})};f.prototype.route=function(t){var e=this;return Object.keys(t).forEach(function(n){r(e.routes,n,t[n])}),this},f.prototype.reject=function(t,e){return n(t,e)},t.Router=f}(this.absoluteRouter=this.absoluteRouter||{});
//# sourceMappingURL=absolute-router.min.js.map
